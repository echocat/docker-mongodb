general:
  artifacts:
    - "images"

machine:
  services:
    - docker

dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install build-essential rsync cpio python unzip bc wget curl git ssh scons libmozjs-dev
    - sudo apt-get remove gcc-4.6 gcc-4.7 gcc-4.8 g++-4.9 g++-4.7 g++-4.9
    - sudo apt-get install gcc-4.8 g++-4.8
  override:
    - docker info

test:
  pre:
    - src/detectVersion
  override:
    - src/build

deployment:
  hub:
    branch: /(master|v.*)/
    commands:
      - docker login -e $DOCKERHUB_EMAIL -u $DOCKERHUB_USER -p $DOCKERHUB_PASS
      - src/deploy
